name: GitHub Actions Demo
on:
  push:
    branches: [MVP2]
jobs:
  Test-App:
    runs-on: ubuntu-latest
    steps:
      - name: Setup Python
        uses: actions/setup-python@v2.3.2
      - name: Check out repository code
        uses: actions/checkout@v2
      - run: python3 --version
      - run: pip install flask
      - run: flask run --host=0.0.0.0 &
      - run: curl localhost:5000
  Build-and-Push:
    runs-on: ubuntu-latest
    needs: Test-App
    steps:
      - name: Build and push Docker images
        # You may pin to the exact commit or the version.
        # uses: docker/build-push-action@7f9d37fa544684fb73bfe4835ed7214c255ce02b
        uses: docker/build-push-action@v2.9.0
#         with:
          # Build's context is the set of files located in the specified PATH or URL
#           context: # optional
#           # Path to the Dockerfile
#           file: # optional
#           # List of metadata for an image
#           labels: # optional
#           # Load is a shorthand for --output=type=docker
#           load: # optional, default is false
#           # Set the networking mode for the RUN instructions during build
#           network: # optional
#           # Do not use cache when building the image
#           no-cache: # optional, default is false
#           # List of output destinations (format: type=local,dest=path)
#           outputs: # optional
#           # List of target platforms for build
#           platforms: # optional
#           # Always attempt to pull a newer version of the image
#           pull: # optional, default is false
#           # Push is a shorthand for --output=type=registry
#           push: # optional, default is false
#           # List of secrets to expose to the build (e.g., key=string, GIT_AUTH_TOKEN=mytoken)
#           secrets: # optional
#           # List of secret files to expose to the build (e.g., key=filename, MY_SECRET=./secret.txt)
#           secret-files: # optional
#           # Size of /dev/shm (e.g., 2g)
#           shm-size: # optional
#           # List of SSH agent socket or keys to expose to the build
#           ssh: # optional
#           # List of tags
#           tags: # optional
#           # Sets the target stage to build
#           target: # optional
#           # Ulimit options (e.g., nofile=1024:1024)
#           ulimit: # optional
#           # GitHub Token used to authenticate against a repository for Git context
#           github-token: # optional, default is ${{ github.token }}
    
# - run: echo "üéâ The job was automatically triggered by a ${{ github.event_name }} event."
# - run: echo "üêß This job is now running on a ${{ runner.os }} server hosted by GitHub!"
# - run: echo "üîé The name of your branch is ${{ github.ref }} and your repository is ${{ github.repository }}."
# - name: Check out repository code
#   uses: actions/checkout@v2
# - run: echo "üí° The ${{ github.repository }} repository has been cloned to the runner."
# - run: echo "üñ•Ô∏è The workflow is now ready to test your code on the runner."
# - name: List files in the repository
#   run: |
#     ls ${{ github.workspace }}
# - run: echo "üçè This job's status is ${{ job.status }}."
